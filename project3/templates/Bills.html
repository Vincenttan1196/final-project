{% extends "layout.html" %}

{% block content %}


    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bills.css') }}">
    <meta charset="UTF-8">
    <title>Bills</title>
</head>

<h1 id = 'billheader'>Current bills</h1>
<div>


<input type="button" onClick="addItem()" value= "add new">

<div id="template">
    <h2>{{ count }}</h2>
    <span>Amount: </span><textarea class="inputbox" id="test1" rows="1" name = 'amount' onchange="uniqueName(this, 'itemname', 'textarea')" ></textarea> <span>Due date</span><textarea class="inputbox" rows="1" name = 'due' onchange="uniqueName(this, 'itemprice', 'textarea')"></textarea> <input type="checkbox">
</div>

<script>
    function addItem() {
        var div = document.createElement('div');
        div.id='';
        div.classList.add("bill");
        div.innerHTML = document.getElementById('template').innerHTML;

        document.getElementById("area").appendChild(div);
        counter = parseInt(document.getElementById("count").textContent);
        counter = counter + 1;
        document.getElementById("count").innerHTML = counter;
    }

function uniqueName(element, name, type){
    var value = '{{ count + 1 }}';
    if(type==="textarea" || type==="select"){
      element.name = "noname";
      var inputs = document.getElementsByTagName(type);
    } else {
      var inputs = document.querySelectorAll("input")
    }

    for (x = 0 ; x < inputs.length ; x++){
      itemname = inputs[x].getAttribute("name");

      if(itemname == null){
        itemname = inputs[x].name;
      }

      if(itemname.indexOf(name) === 0){
        value ++;
      }
    }

    var newname = name + value;
    element.name = newname;
  }


</script>

<form method="post" action = '/bills' id = 'area'>
    <p id = 'count' name = 'counter'> {{ count }}</p>
    {% for i in range(count) %}
    {% set i = i + 1 %}
    {% set i = i|string %}
    {% set x = bill[i] %}

    <div class="bill">
        <h2>Bill {{ i }}</h2>
        <span>Amount: </span><textarea class="inputbox" rows="1" name = 'amount{{ i }}' >{{ x.amount }}</textarea> <span>Due date</span><textarea class="inputbox" rows="1" name = 'due{{ i }}'>{{ x.due }}</textarea>   <select name="category{{ i }}">
    <option value="Water">Water</option>
    <option value="Electricity">Electricity</option>
    <option value="Gas">Gas</option>
    <option value="Data">Data</option>
    <option value="Others">Others</option>
  </select> <input type="checkbox">
    </div>
    {% endfor %}


<input type="submit" class = 'submit' id = 'history'>
</form>



</div>


{% endblock content %}